name: CodeQL Security Scanning

on:
    push:
        branches:
            - master
    pull_request:
        branches:
            - master
    schedule:
        # Run weekly on Mondays at 00:00 UTC
        -   cron: '0 0 * * 1'

permissions:
    contents: read

jobs:
    analyze:
        name: Analyze Code
        runs-on: ubuntu-latest
        permissions:
            actions: read
            contents: read
            security-events: write

        strategy:
            fail-fast: false
            matrix:
                language:
                    - javascript-typescript

        steps:
            -   name: Harden Runner
                uses: step-security/harden-runner@91182cccc01eb5e619899d80e4e971d6181294a7 # v2.10.1
                with:
                    disable-sudo: true
                    egress-policy: audit

            -   name: Checkout code
                uses: actions/checkout@1af3b93b6815bc44a9784bd300feb67ff0d1eeb3 # v6.0.0

            -   name: Initialize CodeQL
                uses: github/codeql-action/init@df409f7d9260372bd5f19e5b04e83cb3c43714ae # v3.27.9
                with:
                    languages: ${{ matrix.language }}
                    queries: security-extended

            -   name: Autobuild
                uses: github/codeql-action/autobuild@df409f7d9260372bd5f19e5b04e83cb3c43714ae # v3.27.9

            -   name: Perform CodeQL Analysis
                uses: github/codeql-action/analyze@df409f7d9260372bd5f19e5b04e83cb3c43714ae # v3.27.9
                with:
                    category: /language:${{ matrix.language }}
