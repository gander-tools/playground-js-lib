name: Secrets Detection

on:
    pull_request:
    push:
        branches:
            - master
    schedule:
        # Run weekly on Sundays at 00:00 UTC
        -   cron: '0 0 * * 0'

permissions:
    contents: read

jobs:
    gitleaks:
        name: Scan for Secrets
        runs-on: ubuntu-latest
        steps:
            -   name: Checkout code
                uses: actions/checkout@1af3b93b6815bc44a9784bd300feb67ff0d1eeb3 # v6.0.0
                with:
                    fetch-depth: 0

            -   name: Run Gitleaks
                uses: gitleaks/gitleaks-action@44c470ffc35caa8b1eb3e8012ca53c2f9bea4eb5 # v2.3.6
                env:
                    GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
